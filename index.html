<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>바카라</title>

<style>
body {
  background:#111;
  color:#fff;
  font-family:Arial;
  text-align:center;
  padding:30px;
}
input, button {
  padding:10px;
  margin:5px;
  font-size:16px;
}
button { cursor:pointer; }
.box {
  border:1px solid #444;
  padding:20px;
  margin-top:20px;
}
.hidden { display:none; }

#top {
  font-size:18px;
  margin-bottom:20px;
}

/* 사다리 */
#ladder {
  display:flex;
  justify-content:center;
  gap:30px;
  margin:20px 0;
}
.line {
  width:6px;
  height:220px;
  background:#555;
}
.line.active {
  animation: drop 1s linear;
  background:#fff;
}
@keyframes drop {
  from { box-shadow: 0 0 0 white; }
  to   { box-shadow: 0 220px 0 white; }
}
</style>
</head>

<body>

<h1>바카라</h1>

<div id="top" class="hidden">
  <span id="topName"></span> |
  현재 포인트: <span id="topPoint"></span>
</div>

<!-- 메인 -->
<div id="main" class="box">
  <input id="name" placeholder="닉네임">
  <input id="point" type="number" placeholder="보유 금액">
  <br>
  <button type="button" onclick="startOddEven()">홀짝</button>
  <button type="button" onclick="startLadder()">사다리</button>
</div>

<!-- 게임 -->
<div id="game" class="box hidden">
  <h2 id="gameTitle"></h2>
  <input id="bet" type="number" placeholder="배팅 금액">

  <div id="gameArea"></div>

  <div id="ladder" class="hidden">
    <div class="line" id="l1"></div>
    <div class="line" id="l2"></div>
    <div class="line" id="l3"></div>
    <div class="line" id="l4"></div>
    <div class="line" id="l5"></div>
  </div>

  <p id="result"></p>
  <button type="button" onclick="back()">← 메인</button>
</div>

<script>
let name, point;

/* DOM */
const nameInput = document.getElementById("name");
const pointInput = document.getElementById("point");
const betInput = document.getElementById("bet");
const main = document.getElementById("main");
const game = document.getElementById("game");
const top = document.getElementById("top");
const topName = document.getElementById("topName");
const topPoint = document.getElementById("topPoint");
const gameTitle = document.getElementById("gameTitle");
const gameArea = document.getElementById("gameArea");
const result = document.getElementById("result");
const ladder = document.getElementById("ladder");

/* 상단 */
function updateTop() {
  topName.innerText = name;
  topPoint.innerText = point;
}

/* 공통 */
function showGame(title) {
  main.classList.add("hidden");
  game.classList.remove("hidden");
  top.classList.remove("hidden");
  gameTitle.innerText = title;
  result.innerText = "";
  updateTop();
}

function initPlayer() {
  name = nameInput.value;
  point = Number(pointInput.value);
  if (!name || !point) {
    alert("닉네임과 보유 금액을 입력해 주세요.");
    return false;
  }
  return true;
}

/* 홀짝 */
function startOddEven() {
  if (!initPlayer()) return;
  showGame("홀짝");
  ladder.classList.add("hidden");
  gameArea.innerHTML = `
    <button type="button" onclick="oddEven('홀')">홀</button>
    <button type="button" onclick="oddEven('짝')">짝</button>
  `;
}

function oddEven(choice) {
  const bet = betCheck();
  if (bet === null) return;

  const r = Math.random() < 0.5 ? "홀" : "짝";
  const m = (choice === r) ? 2 : -1;
  point += bet * m;
  updateTop();

  result.innerText = `결과: ${r} / 배율 ${m}`;
}

/* 사다리 */
function startLadder() {
  if (!initPlayer()) return;
  showGame("사다리");
  ladder.classList.remove("hidden");
  resetLines();

  gameArea.innerHTML = `
    <p>번호 선택</p>
    <button type="button" onclick="ladderPlay(1)">1</button>
    <button type="button" onclick="ladderPlay(2)">2</button>
    <button type="button" onclick="ladderPlay(3)">3</button>
    <button type="button" onclick="ladderPlay(4)">4</button>
    <button type="button" onclick="ladderPlay(5)">5</button>
  `;
}

function ladderPlay(num) {
  const bet = betCheck();
  if (bet === null) return;

  resetLines();
  document.getElementById("l" + num).classList.add("active");

  const multipliers = [3, 2, 0, -1, -2].sort(() => Math.random() - 0.5);
  const multi = multipliers[num - 1];

  setTimeout(() => {
    point += bet * multi;
    updateTop();
    result.innerText = `선택 ${num}번 / 배율 ${multi}`;
  }, 1000);
}

function resetLines() {
  document.querySelectorAll(".line").forEach(l => l.classList.remove("active"));
}

/* 배팅 */
function betCheck() {
  const bet = Number(betInput.value);
  if (!bet || bet <= 0) {
    alert("배팅 금액을 입력해 주세요.");
    return null;
  }
  if (bet > point) {
    alert("보유 금액을 초과했습니다.");
    return null;
  }
  return bet;
}

/* 복귀 */
function back() {
  game.classList.add("hidden");
  main.classList.remove("hidden");
  top.classList.add("hidden");
  betInput.value = "";
}
</script>

</body>
</html>
